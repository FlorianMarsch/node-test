scope.squad={};



scope.loadSquad = function(callback){
	$http({
 		method : 'GET',
 		url : '/api/squad/'+scope.user.id,
 		responseType : 'json'
 	}).then(function(response) {
 		scope.squad=response.data;
 		if(callback){
 			callback();
 		}
 	},function(error) {
 		console.log(error);
 		if(callback){
 			callback(error);
 		}else{
 			scope.active = 'error';
     		scope.error = error;
 		}
 	});
};

$scope.toggle = function (item, list) {
	var idx = list.indexOf(item);
	if (idx > -1) {
	  list.splice(idx, 1);
	}
	else {
	  list.push(item);
	}
  };



scope.linedUp = function(element){
	return scope.squad.lineUp.indexOf(element) > -1;
};
scope.toogleLineUp = function(element){
	if (scope.linedUp(element)) {
		scope.removeFromLineUp(element);
	}else{
		scope.addToLineUp(element);
	}
};

scope.addToLineUp = function(element){
	console.log('add' + element);
	scope.squad.lineUp.push(element);
	scope.saveLineUp();
};
scope.removeFromLineUp = function(element){
	console.log('remove' + element);
	var index = scope.squad.lineUp.indexOf(element);
	if (index > -1) {
		scope.squad.lineUp.splice(index, 1);
		scope.saveLineUp();
	}
};

scope.saveLineUp = function(callback){
	$http({
 		method : 'POST',
 		url : '/api/lineUp/'+scope.user.id,
		 responseType : 'json',
		 data:JSON.stringify(scope.squad.lineUp)
 	}).then(function(response) {
 		scope.squad=response.data;
 		if(callback){
 			callback();
 		}
 	},function(error) {
 		console.log(error);
 		if(callback){
 			callback(error);
 		}else{
 			scope.active = 'error';
     		scope.error = error;
 		}
 	});
};
if(scope.user.id){
	scope.loadSquad();
}
